<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-specification/encryption">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Encryption | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/specification/encryption"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Encryption | p2panda"><meta data-rh="true" name="description" content="While this section is almost fully complete and even implemented, it might be a little rough at the edges: We&#x27;re still working on a fun to use high-level API!"><meta data-rh="true" property="og:description" content="While this section is almost fully complete and even implemented, it might be a little rough at the edges: We&#x27;re still working on a fun to use high-level API!"><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/specification/encryption"><link data-rh="true" rel="alternate" href="https://p2panda.org/specification/encryption" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/specification/encryption" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.de076f58.css">
<link rel="preload" href="/assets/js/runtime~main.e756b0e0.js" as="script">
<link rel="preload" href="/assets/js/main.125a03bc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedImage_ToTc themedImage--light_HNdA"><img src="/images/p2panda-book.png" class="themedImage_ToTc themedImage--dark_i4oU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/learn/">Learn</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/libraries/">Libraries</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/specification/">Specification</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedImage_ToTc themedImage--dark_i4oU"></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/specification/data-types/bamboo">Core data types</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/authorisation">Authorisation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/specification/encryption">Encryption</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/specification/APIs/overview">APIs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/specification/networking/clients-nodes">Networking</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/replication">Replication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/encoding-data">Canonic Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specification/glossary">Glossary</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><img src="/images/deepsea-panda.svg" width="30" class="icon-home_wWeS"></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Encryption</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Encryption: Secret Group</h1><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><span class="panda-icon">üå©Ô∏è</span></span>Under construction</div><div class="admonitionContent_S0QG"><p>While this section is almost fully complete and even <a href="https://github.com/p2panda/p2panda/tree/main/p2panda-rs/src/secret_group" target="_blank" rel="noopener noreferrer">implemented</a>, it might be a little rough at the edges: We&#x27;re still working on a fun to use high-level API!</p></div></div><p>p2panda uses the <a href="https://messaginglayersecurity.rocks/" target="_blank" rel="noopener noreferrer">MLS</a> (Messaging Layer Security) protocol for group key negotiation to establish secrets in a large group of users.</p><p>To allow flexibility for developers, p2panda offers two different settings of encryption: &quot;Sender Ratchet Secrets&quot; or &quot;Long Term Secrets&quot;. Both settings give confidentiality, authenticity and post-compromise security, while the sender ratchet scheme also gives forward secrecy.</p><p>A group of users sharing that secret state is called a &quot;secret group&quot; in p2panda.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">‚Äã</a></h2><p>p2panda is essentially a decentralised database in a trustless network of computers which implies that all user data is stored on the hard disc of an unknown person. To protect data from being read without permission we introduce Secure Groups which allow secure data encryption for any size of group of p2panda users.</p><p>Encryption for a large group of users is already challenging, in a decentralised, trustless setting it gets even harder. p2panda does not &quot;invent&quot; its own solution but relies on the MLS &quot;Messaging Layer Security&quot; protocol to provide state-of-the-art secure group messaging.</p><p>Strong security guarantees do not come &quot;for free&quot;, rather with a couple of caveats which might be confusing for the end users, for example: &quot;Why did my history disappear when I logged in on a new machine?&quot;.</p><p>With this dichotomy in mind, p2panda&#x27;s Secure Groups are designed to provide different security schemes for developers, to be able to decide for the right balance of usability and security, based on the needs of the users or communities, threat-models and use-cases.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="security-settings">Security Settings<a class="hash-link" href="#security-settings" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="plaintext">Plaintext<a class="hash-link" href="#plaintext" title="Direct link to heading">‚Äã</a></h3><p>Data is stored without any encryption.</p><p><strong>Advantages:</strong></p><ul><li>Very easy to implement</li><li>No UX issues in terms of encryption</li></ul><p><strong>Disadvantages:</strong></p><ul><li>Data (from the past) can be read by any peer in the network</li></ul><p><strong>Examples:</strong></p><ul><li>Wiki</li><li>News / Magazine</li><li>...</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="long-term-secrets">Long Term Secrets<a class="hash-link" href="#long-term-secrets" title="Direct link to heading">‚Äã</a></h3><p>Long living AEAD secrets, derived from MLS exporter, used until group admin decides to rotate secret, gives Post-Compromise Security (PCS).</p><p><strong>Advantages:</strong></p><ul><li>Secret can be rotated to disallow removed members to read future data</li><li>Members who join the group later can still access past data</li><li>Client don&#x27;t need to store the decrypted data anywhere</li></ul><p><strong>Disadvantages:</strong></p><ul><li>Larger groups might leak easier the secret</li><li>Attacker will have access to any past data as soon as the secret got compromised</li></ul><p><strong>Examples:</strong></p><ul><li>Club Membership</li><li>Community Chat</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sender-ratchet-secrets">Sender Ratchet Secrets<a class="hash-link" href="#sender-ratchet-secrets" title="Direct link to heading">‚Äã</a></h3><p>Ephemeral AEAD secrets, derived from MLS Secret Tree of current group epoch, used on a per-message base, gives Forward Secrecy (FS) and Post-Compromise Security (PCS).</p><p><strong>Advantages:</strong></p><ul><li>Provides strong security for any size of group, even very large groups</li><li>Every message is encrypted with an individual key, attackers will not be able to read past data or future data when a key got compromised</li></ul><p><strong>Disadvantages:</strong></p><ul><li>Members joining a group later will not be able to decrypt past data</li><li>Clients have to store decrypted messages somewhere on their end as keys get useless soon</li></ul><p><strong>Examples:</strong></p><ul><li>Private Chat</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="system-schemas">System schemas<a class="hash-link" href="#system-schemas" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="secretgroup"><code>SecretGroup</code><a class="hash-link" href="#secretgroup" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">SecretGroup {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  lts_ciphersuite: LongTermSecretCiphersuite,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="keypackage"><code>KeyPackage</code><a class="hash-link" href="#keypackage" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">KeyPackage {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // Pointer at previous KeyPackage from that author</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  previous_key_package: owner(KeyPackage),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // Signed MLS Key Package data</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  mls_key_package: binary(KeyPackage) {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    payload: binary {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      // See MLS Specification Section 7. &quot;Key Packages&quot; for encoded data</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    signature: binary,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    encoded: binary,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="secretgroupcommit"><code>SecretGroupCommit</code><a class="hash-link" href="#secretgroupcommit" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">SecretGroupCommit {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // Points at the secure group this commit belongs to</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  secret_group: owner(SecretGroup),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // Points at the previous commit to bring them into an order</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  previous_commit: owner(SecretGroupCommit),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // MLS Commit Message</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  mls_commit_message: binary(MlsPlaintext) {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    // See MLS Specification Section 9. &quot;Message Framing&quot; and 11.2. &quot;Commit&quot; for encoded data</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // MLS Welcome Message, this is usually sent separately from the Commit to only the members who will join a group. Since we broadcast data anyway we embed the (optional) Welcome message into the `SecretGroupCommit` as well.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  mls_welcome_message: ? binary(Welcome) {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    // See MLS Specification Section 11.2.2. &quot;Welcoming New members&quot; for encoded data</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  // A list of all and past long term secrets of this group, it is encrypted by MLS for the current group epoch of this commit.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  encrypted_long_term_secrets: binary(SecretGroupMessage::MlsApplicationMessage) (</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    // See Specification `SecretGroupMessage`</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    ciphertext: binary(TLSVecU32) [</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      binary(LongTermSecret) {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        // See Specification `LongTermSecret`</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="usage-of-secure-operation-fields">Usage of secure operation fields<a class="hash-link" href="#usage-of-secure-operation-fields" title="Direct link to heading">‚Äã</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">&lt;OperationSchema&gt; {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &lt;key&gt;: {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    secret: SecretGroupMessage {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      // See Specification `SecretGroupMessage`</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ...,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="operation-field-data-type">Operation field Data Type<a class="hash-link" href="#operation-field-data-type" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="secretgroupmessage"><code>SecretGroupMessage</code><a class="hash-link" href="#secretgroupmessage" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">enum SecretGroupMessage {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  LongTermSecretMessage(</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    LongTermSecretCiphertext {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      // See Specification `LongTermSecretCiphertext`</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  MlsApplicationMessage(</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    MlsCiphertext {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      // See MLS Specification Section 9. &quot;Message Framing&quot; for encoded data</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ),</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="long-term-secret-data-types">Long Term Secret Data Types<a class="hash-link" href="#long-term-secret-data-types" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="longtermsecret"><code>LongTermSecret</code><a class="hash-link" href="#longtermsecret" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">LongTermSecret {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  group_id: GroupId,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ciphersuite: LongTermSecretCiphersuite,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  long_term_epoch: LongTermSecretEpoch,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  value: TLSByteVec8,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="longtermciphertext"><code>LongTermCiphertext</code><a class="hash-link" href="#longtermciphertext" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain"> LongTermSecretCiphertext {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  group_id: GroupId,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  long_term_epoch: LongTermSecretEpoch,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  nonce: TlsByteVecU8,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ciphertext: TlsByteVecU8,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="longtermsecretciphersuite"><code>LongTermSecretCiphersuite</code><a class="hash-link" href="#longtermsecretciphersuite" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">enum LongTermSecretCiphersuite {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  PANDA10_AES128GCM = 0x01,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  PANDA10_AES256GCM = 0x02,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  PANDA10_CHACHA20POLY1305 = 0x03,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="longtermsecretepoch"><code>LongTermSecretEpoch</code><a class="hash-link" href="#longtermsecretepoch" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">LongTermSecretEpoch(u64)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="group-evolution">Group evolution<a class="hash-link" href="#group-evolution" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-group">Create group<a class="hash-link" href="#create-group" title="Direct link to heading">‚Äã</a></h3><ol><li>A client chooses a <code>LongTermSecretCiphersuite</code> and announces a new secret group by creating a new <code>SecureGroup</code> document. The resulting hash of this document is used as the <code>group_document_id</code>.</li><li>Together with the <code>group_document_id</code> (used as the MLS group id) and a newly generated MLS <code>KeyPackage</code> from the owner, a new MLS group is established (see <a href="https://messaginglayersecurity.rocks/mls-protocol/draft-ietf-mls-protocol.html#name-group-creation" target="_blank" rel="noopener noreferrer">MLS Specification 10. &quot;Group Creation&quot;</a>). The used key package is created and directly used and does not need to be published on the network.</li><li>The secret group establishes its internal <code>LongTermSecretEpoch</code> counter at <code>0</code>, generates a first <code>LongTermSecret</code>. Every <code>SecretGroup</code> holds at least one long term secret, even when this group is not using any.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="long-term-secret-generation--rotation">Long Term Secret Generation / Rotation<a class="hash-link" href="#long-term-secret-generation--rotation" title="Direct link to heading">‚Äã</a></h3><p>Creating the first or rotating a long term secret follows the same procedure. A long term secret MUST only be generated by the owner of the <code>SecretGroup</code>.</p><p>New long term secrets are not directly announced in the network after generation. Only when the MLS group evolves in its epoch with a <code>SecretGroupCommit</code>, the newly generated long term secrets are encrypted and broadcasted to all group members.</p><p>Every generation MUST result in a new, unique secret. It is not recommended to generate more than one long term secret before creating a new <code>SecretGroupCommit</code> as the secret group does not gain more security from it.</p><ol><li>Increment the internal <code>LongTermSecretEpoch</code> counter by <code>1</code>.</li><li>Derive an AEAD key for the given <code>LongTermSecretCiphersuite</code> by using the internal MLS exporter with the following label: &quot;long_term_secret&quot; (constant value) + current long term secret epoch (incrementing nonce).</li><li>Store the used <code>group_document_id</code>, long term secret ciphersuite, AEAD key and long term secret epoch in a <code>LongTermSecret</code> object.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="add--remove--update-group-members">Add / Remove / Update group members<a class="hash-link" href="#add--remove--update-group-members" title="Direct link to heading">‚Äã</a></h3><p>A <code>SecretGroupCommit</code> MUST only be generated by the owner of the <code>SecreGroup</code>.</p><p>Adding, removing or updating group members yields a <code>SecretGroupCommit</code> which is then announced on the network for all secret groups members to update their internal MLS group state and learn about the latest long term secrets.</p><ol><li>Add / Remove / Update MLS group members (see <a href="https://messaginglayersecurity.rocks/mls-protocol/draft-ietf-mls-protocol.html#name-group-evolution" target="_blank" rel="noopener noreferrer">MLS Specification 11. &quot;Group Evolution&quot;</a>), optionally using <code>SecretGroupProposals</code> on the network for the given secret group.</li><li>The resulting MLS Commit message MUST be directly processed by the group owner to establish the new internal group state and key material for this MLS epoch.</li><li>All currently given <code>LongTermSecrets</code> at this point are collected in an array, sorted by epoch number and encoded via TLS.</li><li>The encoded TLS payload is encrypted using the &quot;Sender Ratchet Secret&quot; of the group&#x27;s new MLS state.</li><li>The result is wrapped in a <code>SecretGroupMessage</code> holding a <code>MlsCiphertext</code>.</li><li>Containing the MLS commit in plaintext, an optional MLS <code>Welcome</code> message (only when adding group members) and the <code>SecretGroupMessage</code> with the encrypted long term secrets the <code>SecretGroupCommit</code> is announced on the network as a new document.</li><li>The <code>SecretGroupCommit</code> MUST point at the previous commit document, except when it is the first.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="processing-commits">Processing commits<a class="hash-link" href="#processing-commits" title="Direct link to heading">‚Äã</a></h3><p>All group members, except for the group owner, need to process the <code>SecretGroupCommit</code> document.</p><ol><li>Take MLS commit from <code>SecretGroupCommit</code> and apply it to MLS group to establish the new group state.</li><li>Check if the member is still part of the group after the commit, if yes we can decrypt the encoded long term secrets payload knowing the new group state. The resulting plaintext is an array of all known <code>LongTermSecrets</code>.</li><li>Store all new long term secrets, remove duplicates (same <code>LongTermSecretEpoch</code>).</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="join-existing-group">Join existing group<a class="hash-link" href="#join-existing-group" title="Direct link to heading">‚Äã</a></h3><p>Invited group members can join a secret group by applying the given <code>SecretGroupCommit</code> document which MUST contain a <code>Welcome</code> message for the new members.</p><ol><li>Take MLS welcome from <code>SecretGroupCommit</code> and use it to establish an MLS group state.</li><li>Decrypt the encoded long term secrets payload knowing the new group state. The resulting plaintext is an array of all known <code>LongTermSecrets</code>.</li><li>Store all new long term secrets.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="announce-members">Announce members<a class="hash-link" href="#announce-members" title="Direct link to heading">‚Äã</a></h3><p>Clients can announce themselves on the network by publishing <code>KeyPackage</code> documents containing key material which is used by MLS to invite new members into a secret group.</p><ol><li>Use p2panda <code>PublicKey</code> as an unique <code>Credential</code> identifier for a secret group member. Use p2panda <code>PrivateKey</code> to sign new MLS key packages.</li><li>Generate new <code>KeyPackage</code> and publish it as a document.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="encryption">Encryption<a class="hash-link" href="#encryption" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sender-ratchet-secrets-1">Sender Ratchet Secrets<a class="hash-link" href="#sender-ratchet-secrets-1" title="Direct link to heading">‚Äã</a></h4><ol><li>Encrypt Operation field values using the MLS &quot;Sender Ratchet&quot; encryption mechanism (see <a href="https://messaginglayersecurity.rocks/mls-protocol/draft-ietf-mls-protocol.html#name-sender-data-encryption" target="_blank" rel="noopener noreferrer">MLS Specification 9.3. &quot;Sender Data Encryption&quot;</a>)</li><li>Wrap resulting MLS Ciphertext in <code>SecretGroupMessage</code>.</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="long-term-secrets-1">Long Term Secrets<a class="hash-link" href="#long-term-secrets-1" title="Direct link to heading">‚Äã</a></h4><ol><li>Get AEAD key from latest <code>LongTermSecret</code> (the one with the highest <code>LongTermSecretEpoch</code>).</li><li>Increment internal AEAD nonce counter by one.</li><li>Generate a new AEAD nonce for the given <code>LongTermSecretCipersuite</code> using the MLS exporter with the following label: &quot;long_term_nonce&quot; (constant value) + public key of client + current AEAD nonce (incremental).</li><li>Encrypt given Operation field value with AEAD nonce, key and encryption method.</li><li>Wrap resulting <code>LongTermSecretCiphertext</code> in <code>SecretGroupMessage</code>.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="decryption">Decryption<a class="hash-link" href="#decryption" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sender-ratchet-secrets-2">Sender Ratchet Secrets<a class="hash-link" href="#sender-ratchet-secrets-2" title="Direct link to heading">‚Äã</a></h4><ol><li>Extract <code>group_document_id</code> and <code>epoch</code> from <code>SecretGroupMessage</code> and make sure it matches with the current MLS group state.</li><li>Download and process new <code>SecretGroupCommits</code> for the <code>SecretGroup</code> when given.</li><li>Decrypt protected Operation field values with known MLS group secrets.</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="long-term-secrets-2">Long Term Secrets<a class="hash-link" href="#long-term-secrets-2" title="Direct link to heading">‚Äã</a></h4><ol><li>Extract <code>group_document_id</code>, <code>LongTermSecretEpoch</code>, AEAD nonce and ciphertext from <code>SecretGroupMessage</code>.</li><li>Download and process new <code>SecretGroupCommits</code> for the <code>SecretGroup</code> when given.</li><li>Look up <code>LongTermSecret</code> for the given epoch.</li><li>Decrypt protected Operation field values with AEAD key and used AEAD nonce.</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="materialisation">Materialisation<a class="hash-link" href="#materialisation" title="Direct link to heading">‚Äã</a></h2><p><strong>Client</strong></p><ol><li>I&#x27;m starting a p2panda client</li><li>I&#x27;m downloading documents via GraphQL of something this client is interested in</li><li>I detect that some values of these documents are encrypted</li><li>I read what <code>SecretGroup</code> document these ciphertexts belong to</li><li>I query which commit addresses me, download all <code>SecretGroupCommits</code> from that point on</li><li>I process the Welcome message via <code>new_from_welcome</code> in that <code>SecretGroupCommit</code> which addresses me</li><li>I decrypt the documents field value</li></ol><p><strong>Node</strong></p><p>The Welcome message contains information about who gets added (see <code>KeyPackageRef</code> in Section 11.2.2).</p><ol><li>During materialisation the node would look at every <code>SecretGroupCommit</code></li><li>Check if it&#x27;s an Add, Remove or Update Commit</li><li>If it&#x27;s an Add Commit, it would look into the Welcome message and it&#x27;s attached <code>KeyPackageRef</code> values</li><li>It would store these information in the database and make them queryable</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="design-notes">Design notes<a class="hash-link" href="#design-notes" title="Direct link to heading">‚Äã</a></h2><ul><li>It is theoretically possible to remove secrets or even reset all secrets during a new MLS group epoch for special scenarios (for example the group decides to not allow any new members to access previous data). The protocol does not prescribe any integrity of the long term secrets, though the default implementation will keep all secrets for now.</li><li>Explain why we encrypt only message values and leak some metadata: Node / Client separation</li><li>Mention burner key pairs: <a href="https://decentpatterns.xyz/library/disposable-identity/" target="_blank" rel="noopener noreferrer">https://decentpatterns.xyz/library/disposable-identity/</a></li><li>Mention why we sign things multiple times (MLS signatures + p2panda signatures)</li><li>Group permissions (who is allowed to add / remove members) can be handled with a key group layer on top</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="potential-issues">Potential issues<a class="hash-link" href="#potential-issues" title="Direct link to heading">‚Äã</a></h2><ul><li>Clients which are not informed about the latest MLS group epoch could encrypt messages based on outdated secrets. Clients could keep past MLS group states to account for messages encrypted in previous epochs, for example in cases of network partition</li><li>MLS application messages are generated with an internal ordering which has a certain tolerance. This out-of-order tolerance should be fairly high in p2panda settings</li><li><code>KeyPackage</code> documents have a <code>LifeTimeExtension</code> which is timestamp based, this timestamp can theoretically be ignored in a trustless setting</li><li>InitKeys could potentially be reused. Clients should send a DELETE operation to key packages after they&#x27;ve joined a group.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/specification/authorisation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Authorisation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/specification/APIs/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#security-settings" class="table-of-contents__link toc-highlight">Security Settings</a><ul><li><a href="#plaintext" class="table-of-contents__link toc-highlight">Plaintext</a></li><li><a href="#long-term-secrets" class="table-of-contents__link toc-highlight">Long Term Secrets</a></li><li><a href="#sender-ratchet-secrets" class="table-of-contents__link toc-highlight">Sender Ratchet Secrets</a></li></ul></li><li><a href="#system-schemas" class="table-of-contents__link toc-highlight">System schemas</a><ul><li><a href="#secretgroup" class="table-of-contents__link toc-highlight"><code>SecretGroup</code></a></li><li><a href="#keypackage" class="table-of-contents__link toc-highlight"><code>KeyPackage</code></a></li><li><a href="#secretgroupcommit" class="table-of-contents__link toc-highlight"><code>SecretGroupCommit</code></a></li></ul></li><li><a href="#usage-of-secure-operation-fields" class="table-of-contents__link toc-highlight">Usage of secure operation fields</a></li><li><a href="#operation-field-data-type" class="table-of-contents__link toc-highlight">Operation field Data Type</a><ul><li><a href="#secretgroupmessage" class="table-of-contents__link toc-highlight"><code>SecretGroupMessage</code></a></li></ul></li><li><a href="#long-term-secret-data-types" class="table-of-contents__link toc-highlight">Long Term Secret Data Types</a><ul><li><a href="#longtermsecret" class="table-of-contents__link toc-highlight"><code>LongTermSecret</code></a></li><li><a href="#longtermciphertext" class="table-of-contents__link toc-highlight"><code>LongTermCiphertext</code></a></li><li><a href="#longtermsecretciphersuite" class="table-of-contents__link toc-highlight"><code>LongTermSecretCiphersuite</code></a></li><li><a href="#longtermsecretepoch" class="table-of-contents__link toc-highlight"><code>LongTermSecretEpoch</code></a></li></ul></li><li><a href="#group-evolution" class="table-of-contents__link toc-highlight">Group evolution</a><ul><li><a href="#create-group" class="table-of-contents__link toc-highlight">Create group</a></li><li><a href="#long-term-secret-generation--rotation" class="table-of-contents__link toc-highlight">Long Term Secret Generation / Rotation</a></li><li><a href="#add--remove--update-group-members" class="table-of-contents__link toc-highlight">Add / Remove / Update group members</a></li><li><a href="#processing-commits" class="table-of-contents__link toc-highlight">Processing commits</a></li><li><a href="#join-existing-group" class="table-of-contents__link toc-highlight">Join existing group</a></li><li><a href="#announce-members" class="table-of-contents__link toc-highlight">Announce members</a></li><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#decryption" class="table-of-contents__link toc-highlight">Decryption</a></li></ul></li><li><a href="#materialisation" class="table-of-contents__link toc-highlight">Materialisation</a></li><li><a href="#design-notes" class="table-of-contents__link toc-highlight">Design notes</a></li><li><a href="#potential-issues" class="table-of-contents__link toc-highlight">Potential issues</a></li></ul></div></div></div></div></main></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union‚Äôs Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="mailto:contributors@p2panda.org">Contact</a></p></footer></div>
<script src="/assets/js/runtime~main.e756b0e0.js"></script>
<script src="/assets/js/main.125a03bc.js"></script>
</body>
</html>